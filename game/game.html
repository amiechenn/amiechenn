<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>今晚翻你牌</title>
<meta name="description" content="">
<meta name="keywords" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, ,maximum-scale=1.0,user-scalable=no">
<link href="" rel="stylesheet">
<style>
    body{font: 12px/1.5 'microsoft yahei', Tahoma;}
	ul{width: 320px;list-style-type: none;padding: 0;margin: auto;}
    ul:after{ content: "";display: table;clear: both;  }
	li{width: 78px;height: 78px;float: left;border: 1px solid #ccc;font-size: 30px;text-align: center;cursor: pointer;padding-top: 15px;box-sizing: border-box;}
    .time{background-color: #fa7600;width: 150px;line-height: 40px;border-radius: 3px;font-size: 20px;color: #fff;margin:auto;margin-top: 10px;text-align: center;}
</style>
</head>
<body>
 	<ul id="box">
 		<li>?</li>
 		<li>?</li>
 		<li>?</li>
 		<li>?</li>
 		<li>?</li>
 		<li>?</li>
 		<li>?</li>
 		<li>?</li>
        <li>?</li>
        <li>?</li>
        <li>?</li>
        <li>?</li>
        <li>?</li>
        <li>?</li>
        <li>?</li>
        <li>?</li>
 	</ul>
    <div class="time">倒计时：<span id="time" >60</span></div>
	<script src="https://amiechenn.github.io/amiechenn/jquery-2.1.3.min.js"></script>
    <script>
    	$(function(){
            var count //到机时
            var game = function(){
                var arr = [], //初始化数组
                    arr2 =[], //随机数组
                    index =0, //数组序号
                    canClick = 1, //1:全部可点击，0为全部可以点击，在翻转为？前使用
                    rightNum = 0, //消除数目
                    first = {}//上一个点击对象容器

                    first.value = null
                    first.index = null
        		function obj(el, options){//每格对象
                    this.$element = el,
                    this.defaults = {
                        'click' : 1,//
                        'value' : '?'
                    }
                    index++
                    arr[index] = this//生成有序数组
                    this.options = $.extend({}, this.defaults, options)
                }
                /*初始化每格对象*/
                for(var i=0;i<2;i++){
                    for(var j=0;j<8;j++){
                        var value = {value:j}
                        new obj(this,value)
                    }
                }
                function randomsort() {
                    return Math.random()>.5 ? -1 : 1;
                    //用Math.random()函数生成0~1之间的随机数与0.5比较，返回-1或1
                }
                /*生成随机数组*/
                arr2 = arr.sort(randomsort);
                /*点击事件+判断*/
                $("#box").find("li").on('click',function(){
                    if(canClick == 1){/*判断是否为可点击期间*/
                        /*查找对应格子对应的对象*/
                        var index = $(this).index()
                        var value = arr2[index].options.value
                        var click = arr2[index].options.click
                        /*判断是否可点击对象*/
                        if(click == 1){
                            canClick = 0
                            $(this).text(value)
                            arr2[index].options.click = 0 //点击后下一次为不可点击
                            t = setTimeout(function(){
                                $("#box").find("li").eq(index).text("?")//1秒后恢复隐藏
                                canClick = 1//1秒后开启点击
                            },500)
                            if(value == first.value){//判断正确
                                clearTimeout(t)//禁止恢复隐藏
                                canClick = 1//判断正常马上可以继续点击下一个
                                $(this).text('')
                                $("#box").find("li").eq(first.index).text('')
                                /*正确对象属性设置为不可点击*/
                                arr2[index].options.click = 0
                                arr2[first.index].options.click = 0
                                first.value = null
                                first.index = null
                                rightNum++
                                if(rightNum == 8){
                                    alert("恭喜，过关！")
                                    clearTimeout(count)
                                }
                            }else{
                                first.index != null ? arr2[first.index].options.click = 1: null
                                first.value = value
                                first.index = index
                            }
                        }
                    }
                })

            }
            game()

            var time = function(){
                var countdown = 60
                  count= setInterval(function(){
                    if(countdown == 0){
                         clearTimeout(count)
                         alert('时间到~弱爆了~')
                    }else{
                        countdown--
                        $("#time").text(countdown)
                    }
                },1000)
            }
            $("#box").one('click',function(){
                time()
            })

    	})
    </script>
</body>
</html>