window.__require=function c(e,t,r){function l(i,n){if(!t[i]){if(!e[i]){var a=i.split("/");if(a=a[a.length-1],!e[a]){var s="function"==typeof __require&&__require;if(!n&&s)return s(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+i+"'")}i=a}var h=t[i]={exports:{}};e[i][0].call(h.exports,function(c){return l(e[i][1][c]||c)},h,h.exports,c,e,t,r)}return t[i].exports}for(var o="function"==typeof __require&&__require,i=0;i<r.length;i++)l(r[i]);return l}({common:[function(c,e){"use strict";cc._RF.push(e,"afc46oIBTZNkLOckvDWOGFh","common");var t={pi:3.1415926,createBlockCheckIsSame:function(c){switch(c){case 1:return c+1;case 2:case 3:case 4:default:return c-1}},randomNum:function(c){var e=Math.ceil(Math.random()*(2*(c-3)+9));return 1<=e&&e<=3?1:4<=e&&e<=6?2:7<=e&&e<=9?3:10<=e&&e<=11?4:1},getBlcokArc:function(c){return 4*Math.asin(c/2/window.circleRadius)},getArcAndRadius:function(c,e){var r={};return r.r=Math.sqrt(c*c+e*e),r.arc=Math.atan(e/c),e>0&&c<0?r.arc=r.arc+t.pi:e<0&&c<0?r.arc=r.arc+t.pi:e<0&&c>=0&&(r.arc=r.arc+2*t.pi),r},getPosition:function(c,e){var t={};return t.x=e*Math.cos(c),t.y=e*Math.sin(c),t},changeArc:function(c){return c<0&&(c=6.28+c),c>6.28&&(c-=6.28),c},sortMinToMax:function(c){if(c.length>0){for(var e=0;e<c.length;e++){var r=c[e];r.arc=t.getArcAndRadius(r.x,r.y).arc,r.selfArcHarf=t.getBlcokArc(r.width/2)/2}c=c.sort(function(c,e){return c.arc-e.arc})}return c},getDelta:function(c,e){var r=c.arc-e.arc;return Math.abs(r)>t.pi&&(r=e.arc>t.pi?2*t.pi-e.arc+c.arc:2*t.pi-c.arc+e.arc),Math.abs(r)},checkBlackIsOverlap:function(c,e){return t.getDelta(c,e).toFixed(6)<(c.selfArcHarf+e.selfArcHarf).toFixed(6)},checkBlackIsInside:function(c,e){if(!t.checkBlackIsOverlap(c,e))return!1;var r=2*t.pi,l=t.pi/2,o=c.arc+c.selfArcHarf,i=c.arc-c.selfArcHarf,n=e.arc+e.selfArcHarf,a=e.arc-e.selfArcHarf;return o>r&&(o-=r),o<0&&(o=r+o),i>r&&(i-=r),i<0&&(i=r+i),n>r&&(n-=r),n<0&&(n=r-n),a>r&&(a-=r),a<0&&(a=r+a),o<l&&i>r-l&&(i-=r,n>r-l&&(n-=r),a>r-l&&(a-=r)),n<l&&a>r-l&&(a-=r,o>r-l&&(o-=r),i>r-l&&(i-=r)),c.width>e.width?o>=n&&i<=a:n>=o&&a<=i},checkBlockBySide:function(c,e){return!(t.getDelta(c,e).toFixed(6)>(c.selfArcHarf+e.selfArcHarf+.0033).toFixed(6))},getOverlapArc:function(c,e){var r=2*t.pi,l=t.pi/2,o=t.changeArc(e.selfArcHarf+e.arc),i=t.changeArc(c.arc-c.selfArcHarf);return o<l&&i>r-l&&(i-=r),i<l&&o>r-l&&(o-=r),o-i},isBlockLfetOrRight:function(c,e){if(void 0===e||void 0===c)return"";var r=e.arc,l=r>t.pi?r-t.pi:r+t.pi;return r<=t.pi?c.arc>r&&c.arc<l?"left":"right":c.arc<r&&c.arc>l?"right":"left"},reSort:function(c,e){var t,r=[];return r=e.slice(c,e.length),t=e.slice(0,c),r.concat(t)},sortRightToLeft:function(c){if(2==c.length&&"left"==t.isBlockLfetOrRight(c[0],c[1]))return c.reverse();for(var e=0;e<c.length;e++){var r=c[e],l=c[e-1];if((0!=r.x||0!=r.y)&&0!=e&&!t.checkBlockBySide(r,l)){var o=c.slice(0,e);return c.slice(e,c.length).concat(o)}}return c}};e.exports=t,cc._RF.pop()},{}],gameOver:[function(c,e){"use strict";cc._RF.push(e,"f4ab5oVpWVDALDe0IBRgZtW","gameOver"),cc.Class({extends:cc.Component,properties:{gameOverScore:cc.Node,gameOverScoreImgPrefab:cc.Prefab,numberAtlas:cc.SpriteAtlas},gameOverScoreImg:function(c){c=c.toString().split("");var e=this.gameOverScore.children.length;if(e<c.length)for(var t=0;t<c.length-e;t++)cc.instantiate(this.gameOverScoreImgPrefab).parent=this.gameOverScore;for(var r=this.gameOverScore.children,l=0;l<c.length;l++)r[l].getComponent(cc.Sprite).spriteFrame=this.numberAtlas.getSpriteFrame(c[l].toString())},start:function(){}}),cc._RF.pop()},{}],game:[function(c,e){"use strict";cc._RF.push(e,"dbfedUGnuxAXpHvUgWQnd9S","game");var t=c("./common");cc.Class({extends:cc.Component,properties:{main:cc.Node,blockBox:cc.Node,ctrlBlockArea:cc.Node,blockAtlas:cc.SpriteAtlas,numberAtlas:cc.SpriteAtlas,motionPrefal:cc.Prefab,boomPrefal:cc.Prefab,audioClip:cc.AudioClip,boomAudioClip:cc.AudioClip,handNode:cc.Node,scoreImgBox:cc.Node,scoreImgPrefab:cc.Prefab,gameOverNode:cc.Node},test:function(){var c=[{x:-149.9357447997648,y:-165.07050745466253,level:1,acr:3.974999756571179,selfArcHarf:.08971618416929489},{x:-100.60762101767565,y:-199.01534260745765,level:3,acr:4.244329532482892,selfArcHarf:.179613538152625},{x:-34.16565121603093,y:-220.36721234563123,level:2,acr:4.5585739260165425,selfArcHarf:.13463080179123252},{x:45.505398559752386,y:-218.30771562617315,level:4,acr:4.917892364973209,selfArcHarf:.224687583575641},{x:143.6720783030873,y:-170.55009210220783,level:5,acr:5.412456499791622,selfArcHarf:.2698765512427715},{x:207.14595427782908,y:-82.58058867753081,level:4,acr:5.903835434610035,selfArcHarf:.224687583575641},{x:222.9117344138634,y:6.273648109609809,level:3,acr:.028136663517886136,selfArcHarf:.179613538152625},{x:-188.45333636952273,y:-119.2239070455062,level:3,acr:3.705669980659466,selfArcHarf:.179613538152625}];this.testB={x:-184.56490646513976,y:-125.15907998029633,level:4};for(var e=0;e<c.length;e++){var t=c[e],r=t.level;aa=new cc.Node("Sprite");var l=aa.addComponent(cc.Sprite);l.sizeMode="CUSTOM",l.spriteFrame=this.blockAtlas.getSpriteFrame(r.toString()),aa.parent=this.blockBox,aa.setPosition(cc.v2(t.x,t.y));var o=this.blockSize+(r-1)*this.blockSizeAdd;aa.setContentSize(cc.size(o,o)),aa.selfArcHarf=t.selfArcHarf,aa.arc=t.arc,aa.level=r}this.createBlock(!0,this.testB.level),this.arrToSort()},testClick:function(){this.ctrlBlcokGo(this.testB),this.createBlock(!1)},init:function(c){this.gameOverNode.active=!1,this.ctrlBlockArea.destroyAllChildren(),this.blockBox.destroyAllChildren(),"fuhuo"!=c&&this.scoreImg(0),this.colorArr=["",new cc.Color(50,125,243,255),new cc.Color(110,8,159,255),new cc.Color(218,27,19,255),new cc.Color(243,205,28,255),new cc.Color(254,114,29,255),new cc.Color(234,138,155,255),new cc.Color(128,196,119,255),new cc.Color(113,68,12,255),new cc.Color(48,154,0,255)],this.blockSize=40,this.blockSizeAdd=20,this.maxLevel=9,this.canCtrlBlcokLevel=4,this.pi=3.1415926,window.circleRadius=223,this.circleRadius=223,this.speedMillisecond=200,this.speedSecond=.2,this.speedMove=.2,this.speedScaleTo=.5,this.ctrlBlock=null,this.clickFlag=!1,this.blockArr=[],this.maxNumInCircle=parseInt(6.28/t.getBlcokArc(this.blockSize+(this.maxLevel-1)*this.blockSizeAdd/2)),this.isGameOver=!1,this.randomBlock={num:0,dir:!0},this.blockBox.zIndex=1,this.ctrlBlockArea.zIndex=9,this.handNode.zIndex=10,this.gameOverNode.zIndex=11,this.firstBlockInCricle(),this.createBlock(!0,1),this.setTouch()},romoveMotion:function(){this.ctrlBlock.getChildByName("motion")&&this.ctrlBlock.getChildByName("motion").destroy()},changeCtrlBlock:function(){if(this.ctrlBlock.level<=this.maxLevel){var c=new cc.Node("Sprite"),e=c.addComponent(cc.Sprite);e.sizeMode="CUSTOM",e.spriteFrame=this.ctrlBlock.getChildByName("ctrlBlock").getComponent(cc.Sprite).spriteFrame,e.srcBlendFactor=cc.macro.BlendFactor.ONE,c.parent=this.blockBox,c.setPosition(cc.v2(this.ctrlBlock.x,this.ctrlBlock.y)),c.setContentSize(cc.size(this.ctrlBlock.width,this.ctrlBlock.height)),c.level=this.ctrlBlock.level}this.ctrlBlock.destroy(),this.ctrlBlock=this.waitBlcok,this.arrToSort()},firstBlockInCricle:function(){var c=new cc.Node("Node"),e=new cc.Node("Sprite");e.parent=c;var r=e.addComponent(cc.Sprite);r.sizeMode="CUSTOM",r.spriteFrame=this.blockAtlas.getSpriteFrame(1..toString()),r.srcBlendFactor=cc.macro.BlendFactor.ONE;var l=this.blockSize+0*this.blockSizeAdd;c.setContentSize(cc.size(l,l)),e.setContentSize(cc.size(l,l)),c.selfArcHarf=t.getBlcokArc(l/2)/2,c.level=1,c.arc=t.getArcAndRadius(0,-this.circleRadius).arc,c.setPosition(cc.v2(0,-this.circleRadius)),c.parent=this.blockBox,this.arrToSort(),this.handNode.active=!0,this.handPlay()},createBlock:function(c,e){var r=this,l=e||t.randomNum(this.canCtrlBlcokLevel);this.waitBlcok=new cc.Node("Node"),this.waitBlcok.parent=this.ctrlBlockArea;var o=new cc.Node("Sprite");o.parent=this.waitBlcok,o.name="ctrlBlock";var i=o.addComponent(cc.Sprite);i.sizeMode="CUSTOM",i.spriteFrame=this.blockAtlas.getSpriteFrame(l.toString()),i.srcBlendFactor=cc.macro.BlendFactor.ONE,this.waitBlcok.setPosition(cc.v2(0,0)),this.waitBlcok.setScale(cc.v2(0,0));var n=this.blockSize+(l-1)*this.blockSizeAdd;this.waitBlcok.setContentSize(cc.size(n,n)),o.setContentSize(cc.size(n,n)),this.waitBlcok.selfArcHarf=t.getBlcokArc(n/2)/2,this.waitBlcok.level=l;var a=cc.instantiate(this.boomPrefal);a.parent=this.waitBlcok,a.color=this.colorArr[l],console.log("waitBlcok",this.waitBlcok);var s=cc.scaleTo(this.speedScaleTo,1,1),h=cc.sequence(s,cc.callFunc(function(){var e=cc.instantiate(r.motionPrefal);e.zIndex=-1;var t=e.getComponent(cc.MotionStreak);t.fadeTime=.1,t.stroke=n,t.color=r.colorArr[l],e.parent=r.waitBlcok,c&&(r.ctrlBlock=r.waitBlcok,r.waitBlcok=null,r.clickFlag=!0)}));this.waitBlcok.runAction(h)},createBlockByCircle:function(c){var e=this,r=t.randomNum(3),l=null;this.randomBlock.dir?r==c[0].level&&(r=t.createBlockCheckIsSame(r)):r==c[c.length-1].level&&(r=t.createBlockCheckIsSame(r));var o=new cc.Node("Node"),i=new cc.Node("Sprite");i.parent=o;var n=i.addComponent(cc.Sprite);n.sizeMode="CUSTOM",n.spriteFrame=this.blockAtlas.getSpriteFrame(r.toString()),n.srcBlendFactor=cc.macro.BlendFactor.ONE,o.setScale(cc.v2(0,0));var a=this.blockSize+(r-1)*this.blockSizeAdd;o.setContentSize(cc.size(a,a)),i.setContentSize(cc.size(a,a)),o.selfArcHarf=t.getBlcokArc(a/2)/2,o.level=r;var s,h=null;if(this.randomBlock.dir)h=c[0].arc-c[0].selfArcHarf-o.selfArcHarf,l=c[c.length-1];else{var f=c.length-1;h=c[f].arc+c[f].selfArcHarf+o.selfArcHarf,l=c[0]}o.arc=h,s=t.getPosition(h,this.circleRadius),o.setPosition(cc.v2(s.x,s.y)),this.isGameOver=c.length>this.maxNumInCircle&&t.checkBlackIsOverlap(l,o),o.parent=this.blockBox;var v=cc.scaleTo(.2,1,1),u=cc.sequence(v,cc.callFunc(function(){if(e.isGameOver)return c.push(o),void e.gameOverAction(l,o,c,[])}));o.runAction(u)},setTouch:function(){this.main.on("touchend",function(c){if(this.clickFlag){this.handNode.active&&(this.handNode.active=!1,this.handStop());var e=c.getLocation();e=this.main.convertToNodeSpaceAR(e),this.ctrlBlcokGo(e),this.randomBlock.num=this.randomBlock.num+1,this.createBlock(!1)}},this)},ctrlBlcokGo:function(c){this.clickFlag=!1;var e=t.getArcAndRadius(c.x,c.y),r=t.getPosition(e.arc,this.circleRadius);this.actionBy=cc.moveTo(this.speedSecond,cc.v2(r.x,r.y)),this.ctrlBlock.arc=e.arc,console.log("\u53d1\u5c04\u6c42\u7684\u4f4d\u7f6exy",{x:r.x,y:r.y,level:this.ctrlBlock.level}),this.checkBlack()},arrToSort:function(){if(3==this.randomBlock.num){var c=this.blockBox.children;c=t.sortMinToMax(c),c=t.sortRightToLeft(c),this.createBlockByCircle(c),this.randomBlock.num=0,this.randomBlock.dir=!this.randomBlock.dir}if(!this.isGameOver){var e=this.blockBox.children;this.blockArr=t.sortMinToMax(e),this.clickFlag=!0}},checkBlack:function(){var c=this,e=0,r=0,l=null,o=null;if(0!=this.blockArr.length){for(var i=0;i<this.blockArr.length;i++){var n=this.blockArr[i];if(0!=n.x||0!=n.y){var a=t.checkBlackIsInside(n,this.ctrlBlock),s=this.ctrlBlock.selfArcHarf+n.selfArcHarf;if(a){"left"==t.isBlockLfetOrRight(n,this.ctrlBlock)?(s=n.arc-s,s=t.changeArc(s),e=null,r=2*this.ctrlBlock.selfArcHarf,l=i):(s=n.arc+s,s=t.changeArc(s),e=2*this.ctrlBlock.selfArcHarf,r=null,l=i==this.blockArr.length-1?0:i+1),this.ctrlBlock.arc=s;var h=t.getPosition(s,this.circleRadius);this.actionBy=cc.moveTo(this.speedSecond,cc.v2(h.x,h.y)),this.playEffect();var f=cc.sequence(this.actionBy,cc.callFunc(function(){c.romoveMotion()}));return this.ctrlBlock.runAction(f),void this.moveAllBlcok(e,r,l,o)}}}for(var v=0;v<this.blockArr.length;v++){var u=this.blockArr[v];0==u.x&&0==u.y||t.checkBlackIsOverlap(u,this.ctrlBlock)&&("left"==t.isBlockLfetOrRight(u,this.ctrlBlock)?(e=t.getOverlapArc(u,this.ctrlBlock),l=v):(r=t.getOverlapArc(this.ctrlBlock,u),o=v))}if(e||r){this.playEffect();var B=cc.sequence(this.actionBy,cc.callFunc(function(){c.romoveMotion()}));this.ctrlBlock.runAction(B),this.moveAllBlcok(e,r,l,o)}else this.moveToNearestBlock()}else{this.playEffect();var k=cc.sequence(this.actionBy,cc.callFunc(function(){c.romoveMotion(),c.changeCtrlBlock()}));this.ctrlBlock.runAction(k)}},splitBlockArr:function(c){for(var e=0;e<c.length;e++){var r=c[e],l=c[e-1];if(0!=r.x||0!=r.y){var o=null,i=null;if(0==e?(o=t.checkBlockBySide(this.ctrlBlock,r),i=t.isBlockLfetOrRight(r,this.ctrlBlock),c.length>1&&this.ctrlBlock.arc-this.ctrlBlock.selfArcHarf<r.arc&&(i="left")):(o=t.checkBlockBySide(l,r),i=t.isBlockLfetOrRight(r,l)),!o||"right"==i||""==i)return{leftArr:c.slice(0,e),rightArr:c.slice(e,c.length).reverse()}}}return{leftArr:c.slice(0,c.length),rightArr:[]}},moveAllBlcok:function(c,e,r,l){var o,i,n=this;null==r&&(r=l+1),o=t.reSort(r,this.blockArr);for(var a=[],s=0;s<o.length;s++){var h=o[s];a[s]={x:h.x,y:h.y,level:h.level,acr:h.arc,selfArcHarf:h.selfArcHarf}}console.log("copyArray",a,r),i=this.splitBlockArr(o),this.isGameOver=o.length>this.maxNumInCircle&&this.checkIsGameOver(i.leftArr,i.rightArr,c,e),this.moveAllBlcokToLeftOrRight("left",c,i.leftArr,function(){if(0==i.rightArr.length){if(n.isGameOver)return;n.moveAllOverCallFun(i.leftArr,i.rightArr)}}),this.moveAllBlcokToLeftOrRight("right",e,i.rightArr,function(){n.isGameOver||n.moveAllOverCallFun(i.leftArr,i.rightArr)})},moveAllBlcokToLeftOrRight:function(c,e,r,l){for(var o=0;o<r.length;o++){var i=r[o],n=i.arc,a="left"==c?i.arc+e:i.arc-e,s=t.changeArc(a);i.arc=s;var h=t.getPosition(a,this.circleRadius),f=cc.moveTo(this.speedMove,cc.v2(h.x,h.y));if(o==r.length-1){var v=[],u=cc.callFunc(function(){l&&l()});if(e>.66){for(var B=parseInt(e/.01),k=0;k<B+1;k++)if(k==B){var g=cc.moveTo(.003,cc.v2(h.x,h.y));v.push(g),v.push(u)}else{var m="left"==c?n+.01*(k+1):n-.01*(k+1),d=t.getPosition(m,this.circleRadius),A=cc.moveTo(.003,cc.v2(d.x,d.y));v.push(A)}var p=cc.sequence(v);i.runAction(p)}else{var C=cc.sequence(f,cc.callFunc(function(){l&&l()}));i.runAction(C)}}else{var y=[];if(e>.66){for(var S=parseInt(e/.01),O=0;O<S+1;O++)if(O==S){var x=cc.moveTo(.003,cc.v2(h.x,h.y));y.push(x)}else{var b="left"==c?n+.01*(O+1):n-.01*(O+1),F=t.getPosition(b,this.circleRadius),T=cc.moveTo(.003,cc.v2(F.x,F.y));y.push(T)}var N=cc.sequence(y);i.runAction(N)}else{var H=cc.sequence(f,cc.callFunc(function(){}));i.runAction(H)}}}},moveAllOverCallFun:function(c,e){var r=this,l=c.length>0&&this.checkLevel(c[0]),o=e.length>0&&this.checkLevel(e[0]);if(l||o)return l&&o?(c[0].destroy(),c.splice(0,1),e[0].destroy(),e.splice(0,1),void this.ctrlBlockLevelUp("mid",function(){if(c.length>0){var l=t.getOverlapArc(c[0],r.ctrlBlock);r.moveAllBlcokToLeftOrRight("left",l,c,function(){0==e.length&&r.moveAllOverCallFun(c,e)})}if(e.length>0){var o=t.getOverlapArc(r.ctrlBlock,e[0]);r.moveAllBlcokToLeftOrRight("right",o,e,function(){r.moveAllOverCallFun(c,e)})}0==c.length&&0==e.length&&r.moveAllOverCallFun(c,e)})):l?(c[0].destroy(),c.splice(0,1),void this.ctrlBlockLevelUp("right",function(){if(c.length>0){var t;t=c[0].arc>r.ctrlBlock.arc?c[0].arc-r.ctrlBlock.arc-c[0].selfArcHarf-r.ctrlBlock.selfArcHarf:c[0].arc+(2*r.pi-r.ctrlBlock.arc)-c[0].selfArcHarf-r.ctrlBlock.selfArcHarf,r.moveAllBlcokToLeftOrRight("right",t,c,function(){r.ctrlBlock.level>r.maxLevel?setTimeout(function(){0!=e.length?r.oneBlcokChangeCtrlBlock(e[0],function(){e[0].destroy(),e.splice(0,1),r.moveAllOverCallFun(c,e)}):r.moveAllOverCallFun(c,e)},100):r.moveAllOverCallFun(c,e)})}else r.moveAllOverCallFun(c,e)})):o?(e[0].destroy(),e.splice(0,1),void this.ctrlBlockLevelUp("left",function(){if(e.length>0){var t;t=r.ctrlBlock.arc>e[0].arc?r.ctrlBlock.arc-e[0].arc-e[0].selfArcHarf-r.ctrlBlock.selfArcHarf:r.ctrlBlock.arc+(2*r.pi-e[0].arc)-e[0].selfArcHarf-r.ctrlBlock.selfArcHarf,r.moveAllBlcokToLeftOrRight("left",t,e,function(){r.ctrlBlock.level>r.maxLevel?setTimeout(function(){0!=c.length?r.oneBlcokChangeCtrlBlock(c[0],function(){c[0].destroy(),c.splice(0,1),r.moveAllOverCallFun(c,e)}):r.moveAllOverCallFun(c,e)},100):r.moveAllOverCallFun(c,e)})}else r.moveAllOverCallFun(c,e)})):void 0;setTimeout(function(){r.changeCtrlBlock()},this.speedMillisecond)},moveToNearestBlock:function(){var c=this.blockArr,e=[],r=this.ctrlBlock.arc;if(1!=c.length)if(r<c[0].arc)(e=t.reSort(0,this.blockArr))[0].arc-r<r+(2*this.pi-e[e.length-1].arc)?this.moveToBlockByCircle(e,"right",0):this.moveToBlockByCircle(e,"left",e.length-1);else if(r>c[c.length-1].arc)(e=t.reSort(0,this.blockArr))[0].arc+(2*this.pi-r)<r-e[e.length-1].arc?this.moveToBlockByCircle(e,"right",0):this.moveToBlockByCircle(e,"left",e.length-1);else for(var l=0;l<c.length;l++)r>c[l].arc&&r<c[l+1].arc&&((e=t.reSort(l+1,this.blockArr))[0].arc-r<r-e[e.length-1].arc?this.moveToBlockByCircle(e,"right",0):this.moveToBlockByCircle(e,"left",e.length-1));else"left"==t.isBlockLfetOrRight(this.ctrlBlock,c[0])?this.moveToBlockByCircle(c,"left",0):this.moveToBlockByCircle(c,"right",0)},moveToBlockByCircle:function(c,e,r){var l=this,o=2*this.pi,i=c[r],n=this.ctrlBlock.selfArcHarf+i.selfArcHarf;n="right"==e?i.arc-n:i.arc+n,n=t.changeArc(n);var a=this.ctrlBlock.arc;this.ctrlBlock.arc=n;var s=Math.abs(n-a);"right"==e?a>this.pi&&n<this.pi&&(s=Math.abs(o-a+n)):n>this.pi&&a<this.pi&&(s=Math.abs(o-n+a)),this.playEffect();var h=cc.sequence(this.actionBy,cc.callFunc(function(){l.romoveMotion();var o=[],i=cc.callFunc(function(){l.moveToBlockByCircleCallFun(c,r)});if(s>.01)for(var h=parseInt(s/.01),f=0;f<h+1;f++)if(f==h){var v=t.getPosition(n,l.circleRadius),u=cc.moveTo(.003,cc.v2(v.x,v.y));o.push(u),o.push(i)}else{var B="right"==e?a+.01*(f+1):a-.01*(f+1),k=t.getPosition(B,l.circleRadius),g=cc.moveTo(.003,cc.v2(k.x,k.y));o.push(g)}else{var m=t.getPosition(n,l.circleRadius),d=cc.moveTo(l.speedMove,cc.v2(m.x,m.y));o.push(d),o.push(i)}var A=cc.sequence(o);setTimeout(function(){l.ctrlBlock.runAction(A)},10)}));this.ctrlBlock.runAction(h)},moveToBlockByCircleCallFun:function(c,e){var t=this,r=c[e];if(this.checkLevel(r))return 0==e&&1==c.length?(c[0].destroy(),void this.ctrlBlockLevelUp("mid",function(){t.changeCtrlBlock()})):0==e?(c[e].destroy(),c.splice(e,1),void this.ctrlBlockLevelUp("right",function(){var e;c.length>0?(e=c[0].arc-t.ctrlBlock.arc-c[0].selfArcHarf-t.ctrlBlock.selfArcHarf,t.moveAllBlcokToLeftOrRight("right",e,c,function(){t.moveToBlockByCircleCallFun(c,0)})):t.changeCtrlBlock()})):(c[e].destroy(),c.splice(e,1),void this.ctrlBlockLevelUp("left",function(){var r;c.length>0?(r=t.ctrlBlock.arc-c[e-1].arc-c[e-1].selfArcHarf-t.ctrlBlock.selfArcHarf,t.moveAllBlcokToLeftOrRight("left",r,c,function(){t.moveToBlockByCircleCallFun(c,e-1)})):t.changeCtrlBlock()}));this.changeCtrlBlock()},checkLevel:function(c){return c.level==this.ctrlBlock.level},ctrlBlockLevelUp:function(c,e){var r=this;this.playEffectBoomAudioClip(),this.ctrlBlock.getChildByName("boom").getComponent(cc.Animation).play(),this.scoreImg(parseInt(this.score)+parseInt(this.ctrlBlock.level));var l=this.blockSize+this.ctrlBlock.level*this.blockSizeAdd,o=t.getBlcokArc(l/2)/2,i=this.ctrlBlock.arc;"right"==c?i=this.ctrlBlock.arc-this.ctrlBlock.selfArcHarf+o:"left"==c&&(i=this.ctrlBlock.arc+this.ctrlBlock.selfArcHarf-o);var n=t.getPosition(i,this.circleRadius);this.ctrlBlock.getChildByName("ctrlBlock").runAction(cc.scaleTo(.2,0,0)),setTimeout(function(){r.ctrlBlock.level=r.ctrlBlock.level+1,r.ctrlBlock.setPosition(cc.v2(n.x,n.y)),r.ctrlBlock.level<r.maxLevel+1?(r.ctrlBlock.setContentSize(cc.size(l,l)),r.ctrlBlock.getChildByName("ctrlBlock").setContentSize(cc.size(l,l)),r.ctrlBlock.getChildByName("ctrlBlock").getComponent(cc.Sprite).spriteFrame=r.blockAtlas.getSpriteFrame(r.ctrlBlock.level.toString()),r.ctrlBlock.getChildByName("ctrlBlock").getComponent(cc.Sprite).srcBlendFactor=cc.macro.BlendFactor.ONE,r.ctrlBlock.getChildByName("ctrlBlock").runAction(cc.scaleTo(.2,1,1)),setTimeout(function(){r.ctrlBlock.getChildByName("boom").color=r.colorArr[r.ctrlBlock.level]},400),r.ctrlBlock.selfArcHarf=o,r.ctrlBlock.arc=i):(r.ctrlBlock.setContentSize(cc.size(0,0)),r.ctrlBlock.getChildByName("ctrlBlock").setContentSize(cc.size(0,0)),"right"==c?i-=o:"left"==c&&(i+=o),r.ctrlBlock.arc=i,r.ctrlBlock.selfArcHarf=0),e&&e()},this.speedMillisecond)},oneBlcokChangeCtrlBlock:function(c,e){var t=c.level,r=new cc.Node("Node"),l=new cc.Node("Sprite");l.parent=r,l.name="ctrlBlock";var o=l.addComponent(cc.Sprite);o.sizeMode="CUSTOM",o.spriteFrame=this.blockAtlas.getSpriteFrame(t.toString()),o.srcBlendFactor=cc.macro.BlendFactor.ONE,r.setPosition(cc.v2(c.x,c.y));var i=this.blockSize+(t-1)*this.blockSizeAdd;r.setContentSize(cc.size(i,i)),l.setContentSize(cc.size(i,i)),r.selfArcHarf=c.selfArcHarf,r.arc=c.arc,r.level=t,r.parent=this.ctrlBlockArea;var n=cc.instantiate(this.boomPrefal);n.parent=r,n.color=this.colorArr[t],this.ctrlBlock.destroy(),this.ctrlBlock=r,e&&e()},gameOverAction:function(c,e,t,r){var l=this,o=cc.repeat(cc.sequence(cc.scaleTo(.5,.7,.7),cc.scaleTo(.5,1,1)),3),i=cc.repeat(cc.sequence(cc.scaleTo(.5,.7,.7),cc.scaleTo(.5,1,1)),2);c.runAction(o),e.runAction(i),setTimeout(function(){if(t.length>0&&r.length>0){t=t.reverse(),r=r.reverse();for(var c=function(c){c==t.length?t.length>=r.length&&setTimeout(function(){l.playEffectBoomAudioClip(),l.ctrlBlock.getChildByName("boom").getComponent(cc.Animation).play(),l.ctrlBlock.destroy(),l.gameOverScene()},150*c):setTimeout(function(){l.boomArr(t[c])},150*c)},e=0;e<t.length+1;e++)c(e);for(var o=function(c){c==r.length?r.length>t.length&&setTimeout(function(){l.playEffectBoomAudioClip(),l.ctrlBlock.getChildByName("boom").getComponent(cc.Animation).play(),l.ctrlBlock.destroy(),l.gameOverScene()},150*c):setTimeout(function(){l.boomArr(r[c])},150*c)},i=0;i<r.length+1;i++)o(i)}0!=t.length&&0!=r.length||function(){var c=t.length>0?t:r;c=c.reverse();for(var e=function(e){e==c.length?setTimeout(function(){l.playEffectBoomAudioClip(),l.ctrlBlock.getChildByName("boom").getComponent(cc.Animation).play(),l.ctrlBlock.destroy(),l.gameOverScene()},150*e):setTimeout(function(){l.boomArr(c[e])},150*e)},o=0;o<c.length+1;o++)e(o)}()},2e3)},boomArr:function(c){var e=cc.instantiate(this.boomPrefal);e.color=this.colorArr[c.level],e.setPosition(cc.v2(c.x,c.y)),e.parent=this.blockBox,this.playEffectBoomAudioClip(),e.getComponent(cc.Animation).play(),c.destroy()},checkIsGameOver:function(c,e,r,l){if(c.length>0&&e.length>0){var o=c[c.length-1],i=e[e.length-1];return t.getDelta(o,i)-o.selfArcHarf-i.selfArcHarf<=2*this.ctrlBlock.selfArcHarf&&(this.gameOverAction(o,i,c,e),!0)}if(0==c.length){var n=e[e.length-1],a=this.ctrlBlock;return t.getDelta(n,a)-n.selfArcHarf-a.selfArcHarf<=l&&(this.gameOverAction(n,a,c,e),!0)}if(0==e.length){var s=c[c.length-1],h=this.ctrlBlock;return t.getDelta(s,h)-s.selfArcHarf-h.selfArcHarf<=r&&(this.gameOverAction(s,h,c,e),!0)}},gameOverScene:function(){this.gameOverNode.getComponent("gameOver").gameOverScoreImg(this.score),this.gameOverNode.active=!0},clickStart:function(){var c=this;FBInstant.getInterstitialAdAsync("541606183515187_542798350062637").then(function(c){return c.loadAsync()}).then(function(){return c.init(),null.showAsync()}).catch(function(c){console.log(c)})},clickFuhuo:function(c,e){var r=this,l=null;FBInstant.getRewardedVideoAsync("541606183515187_542797943396011").then(function(c){return void 0!==c?(void 0===c.getPlacementID()&&console.log("can not get placement ID"),l=c,c.loadAsync()):Promise.reject(new Error("rewardedVideo is undefined"))}).then(function(){return l.showAsync()}).then(function(){if("fuhuo"==e)r.init("fuhuo");else{var c=t.randomNum(4),l=this.ctrlBlock.level;this.waitBlcok&&this.waitBlcok.destroy(),this.ctrlBlock&&this.ctrlBlock.destroy(),c==l&&(c=t.createBlockCheckIsSame(c)),this.createBlock(!0,c)}}).catch(function(c){console.log(c)})},shareGame:function(){FBInstant.context.chooseAsync().then(function(){FBInstant.updateAsync({action:"CUSTOM",template:"top_score",cta:"Race "+FBInstant.player.getName(),image:"BASE64",text:{default:"I Challenge You To A Race!"},data:{myReplayData:"..."},strategy:"LAST",notification:"NO_PUSH"}).then(function(){})})},playEffect:function(){cc.audioEngine.play(this.audioClip,!1,1)},playEffectBoomAudioClip:function(){cc.audioEngine.play(this.boomAudioClip,!1,1)},handPlay:function(){this.handNode.getComponent(cc.Animation).play()},handStop:function(){this.handNode.getComponent(cc.Animation).stop()},scoreImg:function(c){this.score=c,c=this.score.toString().split("");var e=this.scoreImgBox.children.length;if(e<c.length)for(var t=0;t<c.length-e;t++)cc.instantiate(this.scoreImgPrefab).parent=this.scoreImgBox;for(var r=this.scoreImgBox.children,l=0;l<c.length;l++)r[l].getComponent(cc.Sprite).spriteFrame=this.numberAtlas.getSpriteFrame(c[l].toString())},onLoad:function(){this.init()},start:function(){},update:function(){}}),cc._RF.pop()},{"./common":"common"}]},{},["common","game","gameOver"]);