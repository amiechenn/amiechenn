window.__require=function t(c,e,r){function l(o,n){if(!e[o]){if(!c[o]){var s=o.split("/");if(s=s[s.length-1],!c[s]){var a="function"==typeof __require&&__require;if(!n&&a)return a(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+o+"'")}o=s}var h=e[o]={exports:{}};c[o][0].call(h.exports,function(t){return l(c[o][1][t]||t)},h,h.exports,t,c,e,r)}return e[o].exports}for(var i="function"==typeof __require&&__require,o=0;o<r.length;o++)l(r[o]);return l}({game:[function(t,c){"use strict";cc._RF.push(c,"dbfedUGnuxAXpHvUgWQnd9S","game"),cc.Class({extends:cc.Component,properties:{blockBox:cc.Node,ctrlBlockArea:cc.Node,blockAtlas:cc.SpriteAtlas,numberAtlas:cc.SpriteAtlas,motionPrefal:cc.Prefab,boomPrefal:cc.Prefab,scoreLabel:cc.Label,gameOver:cc.Node,gameOverScore:cc.Label,audioClip:cc.AudioClip,boomAudioClip:cc.AudioClip,handNode:cc.Node,scoreImgBox:cc.Node,scoreImgPrefab:cc.Prefab},test:function(){var t=[];this.testB={x:68.20162182695145,y:-233.23279953765828,level:4};for(var c=0;c<t.length;c++){var e=t[c],r=e.level;aa=new cc.Node("Sprite");var l=aa.addComponent(cc.Sprite);l.sizeMode="CUSTOM",l.spriteFrame=this.blockAtlas.getSpriteFrame(r.toString()),aa.parent=this.blockBox,aa.setPosition(cc.v2(e.x,e.y));var i=this.blockSize+(r-1)*this.blockSizeAdd;aa.setContentSize(cc.size(i,i)),aa.selfArcHarf=e.selfArcHarf,aa.arc=e.arc,aa.level=r}this.createBlock(!0,this.testB.level),this.arrToSort()},testClick:function(){this.ctrlBlcokGo(this.testB),this.createBlock(!1)},init:function(t){this.gameOver.active=!1,this.ctrlBlockArea.destroyAllChildren(),this.blockBox.destroyAllChildren(),"fuhuo"!=t&&(this.scoreLabel.string=0,this.scoreImg(0)),this.colorArr=["",new cc.Color(0,133,255,255),new cc.Color(255,0,20,255),new cc.Color(143,13,216,255),new cc.Color(255,245,0,255),new cc.Color(246,126,7,255),new cc.Color(246,7,88,255),new cc.Color(0,255,5,255),new cc.Color(106,58,58,255),new cc.Color(251,11,11,255)],this.blockSize=40,this.blockSizeAdd=20,this.maxLevel=9,this.canCtrlBlcokLevel=4,this.pi=3.1415926,this.circleRadius=243,this.speedMillisecond=200,this.speedSecond=.2,this.speedMove=.2,this.speedScaleTo=.5,this.ctrlBlock=null,this.clickFlag=!1,this.blockArr=[],this.maxNumInCircle=parseInt(6.28/this.getBlcokArc(this.blockSize+(this.maxLevel-1)*this.blockSizeAdd/2)),this.isGameOver=!1,this.randomBlock={num:0,dir:!0},this.blockBox.zIndex=1,this.ctrlBlockArea.zIndex=9,this.handNode.zIndex=10,this.gameOver.zIndex=11,this.firstBlockInCricle(),this.createBlock(!0,1),this.setTouch()},randomNum:function(t){var c=Math.ceil(Math.random()*(2*(t-3)+9));return 1<=c&&c<=3?1:4<=c&&c<=6?2:7<=c&&c<=9?3:10<=c&&c<=11?4:1},romoveMotion:function(){this.ctrlBlock.getChildByName("motion")&&this.ctrlBlock.getChildByName("motion").destroy()},changeCtrlBlock:function(){if(this.ctrlBlock.level<=this.maxLevel){var t=new cc.Node("Sprite"),c=t.addComponent(cc.Sprite);c.sizeMode="CUSTOM",c.spriteFrame=this.ctrlBlock.getChildByName("ctrlBlock").getComponent(cc.Sprite).spriteFrame,t.parent=this.blockBox,t.setPosition(cc.v2(this.ctrlBlock.x,this.ctrlBlock.y)),t.setContentSize(cc.size(this.ctrlBlock.width,this.ctrlBlock.height)),t.level=this.ctrlBlock.level}this.ctrlBlock.destroy(),this.ctrlBlock=this.waitBlcok,this.arrToSort()},firstBlockInCricle:function(){var t=new cc.Node("Node"),c=new cc.Node("Sprite");c.parent=t;var e=c.addComponent(cc.Sprite);e.sizeMode="CUSTOM",e.spriteFrame=this.blockAtlas.getSpriteFrame(1..toString());var r=this.blockSize+0*this.blockSizeAdd;t.setContentSize(cc.size(r,r)),c.setContentSize(cc.size(r,r)),t.selfArcHarf=this.getBlcokArc(r/2)/2,t.level=1,t.arc=this.getArcAndRadius(0,-this.circleRadius).arc,t.setPosition(cc.v2(0,-this.circleRadius)),t.parent=this.blockBox,this.arrToSort(),this.handNode.active=!0,this.handPlay()},createBlock:function(t,c){var e=this,r=c||this.randomNum(this.canCtrlBlcokLevel);this.waitBlcok=new cc.Node("Node"),this.waitBlcok.parent=this.ctrlBlockArea;var l=new cc.Node("Sprite");l.parent=this.waitBlcok,l.name="ctrlBlock";var i=l.addComponent(cc.Sprite);i.sizeMode="CUSTOM",i.spriteFrame=this.blockAtlas.getSpriteFrame(r.toString()),this.waitBlcok.setPosition(cc.v2(0,0)),this.waitBlcok.setScale(cc.v2(0,0));var o=this.blockSize+(r-1)*this.blockSizeAdd;this.waitBlcok.setContentSize(cc.size(o,o)),l.setContentSize(cc.size(o,o)),this.waitBlcok.selfArcHarf=this.getBlcokArc(o/2)/2,this.waitBlcok.level=r;var n=cc.instantiate(this.boomPrefal);n.parent=this.waitBlcok,n.color=this.colorArr[r],console.log("waitBlcok",this.waitBlcok);var s=cc.scaleTo(this.speedScaleTo,1,1),a=cc.sequence(s,cc.callFunc(function(){var c=cc.instantiate(e.motionPrefal);c.zIndex=-1;var l=c.getComponent(cc.MotionStreak);l.fadeTime=.1,l.stroke=o,l.color=e.colorArr[r],c.parent=e.waitBlcok,t&&(e.ctrlBlock=e.waitBlcok,e.waitBlcok=null,e.clickFlag=!0)}));this.waitBlcok.runAction(a)},createBlockCheckIsSame:function(t){switch(t){case 1:return t+1;case 2:case 3:case 4:default:return t-1}},createBlockByCircle:function(t){var c=this,e=this.randomNum(3),r=null;this.randomBlock.dir?e==t[0].level&&(e=this.createBlockCheckIsSame(e)):e==t[t.length-1].level&&(e=this.createBlockCheckIsSame(e));var l=new cc.Node("Node"),i=new cc.Node("Sprite");i.parent=l;var o=i.addComponent(cc.Sprite);o.sizeMode="CUSTOM",o.spriteFrame=this.blockAtlas.getSpriteFrame(e.toString()),l.setScale(cc.v2(0,0));var n=this.blockSize+(e-1)*this.blockSizeAdd;l.setContentSize(cc.size(n,n)),i.setContentSize(cc.size(n,n)),l.selfArcHarf=this.getBlcokArc(n/2)/2,l.level=e;var s,a=null;if(this.randomBlock.dir)a=t[0].arc-t[0].selfArcHarf-l.selfArcHarf,r=t[t.length-1];else{var h=t.length-1;a=t[h].arc+t[h].selfArcHarf+l.selfArcHarf,r=t[0]}l.arc=a,s=this.getPosition(a,this.circleRadius),l.setPosition(cc.v2(s.x,s.y)),this.isGameOver=t.length>this.maxNumInCircle&&this.checkBlackIsOverlap(r,l),l.parent=this.blockBox;var f=cc.scaleTo(.2,1,1),u=cc.sequence(f,cc.callFunc(function(){if(c.isGameOver)return t.push(l),void c.gameOverAction(r,l,t,[])}));l.runAction(u)},setTouch:function(){this.node.on("touchend",function(t){if(this.clickFlag){this.handNode.active&&(this.handNode.active=!1,this.handStop());var c=t.getLocation();c=this.node.convertToNodeSpaceAR(c),this.ctrlBlcokGo(c),this.randomBlock.num=this.randomBlock.num+1,this.createBlock(!1)}},this)},ctrlBlcokGo:function(t){this.clickFlag=!1;var c=this.getArcAndRadius(t.x,t.y),e=this.getPosition(c.arc,this.circleRadius);this.actionBy=cc.moveTo(this.speedSecond,cc.v2(e.x,e.y)),this.ctrlBlock.arc=c.arc,console.log("\u53d1\u5c04\u6c42\u7684\u4f4d\u7f6exy",{x:e.x,y:e.y,level:this.ctrlBlock.level}),this.checkBlack()},getBlcokArc:function(t){return 4*Math.asin(t/2/this.circleRadius)},getArcAndRadius:function(t,c){var e={};return e.r=Math.sqrt(t*t+c*c),e.arc=Math.atan(c/t),c>0&&t<0?e.arc=e.arc+this.pi:c<0&&t<0?e.arc=e.arc+this.pi:c<0&&t>=0&&(e.arc=e.arc+2*this.pi),e},getPosition:function(t,c){var e={};return e.x=c*Math.cos(t),e.y=c*Math.sin(t),e},changeArc:function(t){var c=2*this.pi;return t<0&&(t=c+t),t>c&&(t-=c),t},sortMinToMax:function(t){if(t.length>0){for(var c=0;c<t.length;c++){var e=t[c];e.arc=this.getArcAndRadius(e.x,e.y).arc,e.selfArcHarf=this.getBlcokArc(e.width/2)/2}t=t.sort(function(t,c){return t.arc-c.arc})}return t},sortRightToLeft:function(t){if(2==t.length&&"left"==this.isBlockLfetOrRight(t[0],t[1]))return t.reverse();for(var c=0;c<t.length;c++){var e=t[c],r=t[c-1];if((0!=e.x||0!=e.y)&&0!=c&&!this.checkBlockBySide(e,r)){var l=t.slice(0,c);return t.slice(c,t.length).concat(l)}}return t},arrToSort:function(){if(3==this.randomBlock.num){var t=this.blockBox.children;t=this.sortMinToMax(t),t=this.sortRightToLeft(t),this.createBlockByCircle(t),this.randomBlock.num=0,this.randomBlock.dir=!this.randomBlock.dir}if(!this.isGameOver){var c=this.blockBox.children;this.blockArr=this.sortMinToMax(c),this.clickFlag=!0}},checkBlack:function(){var t=this,c=0,e=0,r=null,l=null;if(0!=this.blockArr.length){for(var i=0;i<this.blockArr.length;i++){var o=this.blockArr[i];if(0!=o.x||0!=o.y){var n=this.checkBlackIsInside(o,this.ctrlBlock),s=this.ctrlBlock.selfArcHarf+o.selfArcHarf;if(n){"left"==this.isBlockLfetOrRight(o,this.ctrlBlock)?(s=o.arc-s,s=this.changeArc(s),c=null,e=2*this.ctrlBlock.selfArcHarf,r=i):(s=o.arc+s,s=this.changeArc(s),c=2*this.ctrlBlock.selfArcHarf,e=null,r=i==this.blockArr.length-1?0:i+1),this.ctrlBlock.arc=s;var a=this.getPosition(s,this.circleRadius);this.actionBy=cc.moveTo(this.speedSecond,cc.v2(a.x,a.y)),this.playEffect();var h=cc.sequence(this.actionBy,cc.callFunc(function(){t.romoveMotion()}));return this.ctrlBlock.runAction(h),void this.moveAllBlcok(c,e,r,l)}}}for(var f=0;f<this.blockArr.length;f++){var u=this.blockArr[f];0==u.x&&0==u.y||this.checkBlackIsOverlap(u,this.ctrlBlock)&&("left"==this.isBlockLfetOrRight(u,this.ctrlBlock)?(c=this.getOverlapArc(u,this.ctrlBlock),r=f):(e=this.getOverlapArc(this.ctrlBlock,u),l=f))}if(c||e){this.playEffect();var v=cc.sequence(this.actionBy,cc.callFunc(function(){t.romoveMotion()}));this.ctrlBlock.runAction(v),this.moveAllBlcok(c,e,r,l)}else this.moveToNearestBlock()}else{this.playEffect();var k=cc.sequence(this.actionBy,cc.callFunc(function(){t.romoveMotion(),t.changeCtrlBlock()}));this.ctrlBlock.runAction(k)}},checkBlackIsInside:function(t,c){if(!this.checkBlackIsOverlap(t,c))return!1;var e=2*this.pi,r=this.pi/2,l=t.arc+t.selfArcHarf,i=t.arc-t.selfArcHarf,o=c.arc+c.selfArcHarf,n=c.arc-c.selfArcHarf;return l>e&&(l-=e),l<0&&(l=e+l),i>e&&(i-=e),i<0&&(i=e+i),o>e&&(o-=e),o<0&&(o=e-o),n>e&&(n-=e),n<0&&(n=e+n),l<r&&i>e-r&&(i-=e,o>e-r&&(o-=e),n>e-r&&(n-=e)),o<r&&n>e-r&&(n-=e,l>e-r&&(l-=e),i>e-r&&(i-=e)),t.width>c.width?l>=o&&i<=n:o>=l&&n<=i},checkBlackIsOverlap:function(t,c){return this.getDelta(t,c).toFixed(6)<(t.selfArcHarf+c.selfArcHarf).toFixed(6)},checkBlockBySide:function(t,c){return!(this.getDelta(t,c).toFixed(6)>(t.selfArcHarf+c.selfArcHarf+1e-5).toFixed(6))},getOverlapArc:function(t,c){var e=2*this.pi,r=this.pi/2,l=this.changeArc(c.selfArcHarf+c.arc),i=this.changeArc(t.arc-t.selfArcHarf);return l<r&&i>e-r&&(i-=e),i<r&&l>e-r&&(l-=e),l-i},reSort:function(t){var c,e=[];return e=this.blockArr.slice(t,this.blockArr.length),c=this.blockArr.slice(0,t),e.concat(c)},splitBlockArr:function(t){for(var c=0;c<t.length;c++){var e=t[c],r=t[c-1];if(0!=e.x||0!=e.y){var l=null,i=null;if(0==c?(l=this.checkBlockBySide(this.ctrlBlock,e),i=this.isBlockLfetOrRight(e,this.ctrlBlock),t.length>1&&this.ctrlBlock.arc-this.ctrlBlock.selfArcHarf<e.arc&&(i="left")):(l=this.checkBlockBySide(r,e),i=this.isBlockLfetOrRight(e,r)),!l||"right"==i||""==i)return{leftArr:t.slice(0,c),rightArr:t.slice(c,t.length).reverse()}}}return{leftArr:t.slice(0,t.length),rightArr:[]}},moveAllBlcok:function(t,c,e,r){var l,i,o=this;null==e&&(e=r+1),l=this.reSort(e);for(var n=[],s=0;s<l.length;s++){var a=l[s];n[s]={x:a.x,y:a.y,level:a.level,acr:a.arc,selfArcHarf:a.selfArcHarf}}console.log("copyArray",n),i=this.splitBlockArr(l),this.isGameOver=l.length>this.maxNumInCircle&&this.checkIsGameOver(i.leftArr,i.rightArr,t,c),this.moveAllBlcokToLeftOrRight("left",t,i.leftArr,function(){if(0==i.rightArr.length){if(o.isGameOver)return;o.moveAllOverCallFun(i.leftArr,i.rightArr)}}),this.moveAllBlcokToLeftOrRight("right",c,i.rightArr,function(){o.isGameOver||o.moveAllOverCallFun(i.leftArr,i.rightArr)})},moveAllBlcokToLeftOrRight:function(t,c,e,r){for(var l=0;l<e.length;l++){var i=e[l],o=i.arc,n="left"==t?i.arc+c:i.arc-c,s=this.changeArc(n);i.arc=s;var a=this.getPosition(n,this.circleRadius),h=cc.moveTo(this.speedMove,cc.v2(a.x,a.y));if(l==e.length-1){var f=[],u=cc.callFunc(function(){r&&r()});if(c>.66){for(var v=parseInt(c/.01),k=0;k<v+1;k++)if(k==v){var B=cc.moveTo(.003,cc.v2(a.x,a.y));f.push(B),f.push(u)}else{var g="left"==t?o+.01*(k+1):o-.01*(k+1),d=this.getPosition(g,this.circleRadius),m=cc.moveTo(.003,cc.v2(d.x,d.y));f.push(m)}var A=cc.sequence(f);i.runAction(A)}else{var p=cc.sequence(h,cc.callFunc(function(){r&&r()}));i.runAction(p)}}else{var C=[];if(c>.66){for(var y=parseInt(c/.01),S=0;S<y+1;S++)if(S==y){var b=cc.moveTo(.003,cc.v2(a.x,a.y));C.push(b)}else{var T="left"==t?o+.01*(S+1):o-.01*(S+1),O=this.getPosition(T,this.circleRadius),x=cc.moveTo(.003,cc.v2(O.x,O.y));C.push(x)}var F=cc.sequence(C);i.runAction(F)}else{var H=cc.sequence(h,cc.callFunc(function(){}));i.runAction(H)}}}},moveAllOverCallFun:function(t,c){var e=this,r=t.length>0&&this.checkLevel(t[0]),l=c.length>0&&this.checkLevel(c[0]);if(r||l)return r&&l?(t[0].destroy(),t.splice(0,1),c[0].destroy(),c.splice(0,1),void this.ctrlBlockLevelUp("mid",function(){if(t.length>0){var r=e.getOverlapArc(t[0],e.ctrlBlock);e.moveAllBlcokToLeftOrRight("left",r,t,function(){0==c.length&&e.moveAllOverCallFun(t,c)})}if(c.length>0){var l=e.getOverlapArc(e.ctrlBlock,c[0]);e.moveAllBlcokToLeftOrRight("right",l,c,function(){e.moveAllOverCallFun(t,c)})}0==t.length&&0==c.length&&e.moveAllOverCallFun(t,c)})):r?(t[0].destroy(),t.splice(0,1),void this.ctrlBlockLevelUp("right",function(){if(t.length>0){var r;r=t[0].arc>e.ctrlBlock.arc?t[0].arc-e.ctrlBlock.arc-t[0].selfArcHarf-e.ctrlBlock.selfArcHarf:t[0].arc+(2*e.pi-e.ctrlBlock.arc)-t[0].selfArcHarf-e.ctrlBlock.selfArcHarf,e.moveAllBlcokToLeftOrRight("right",r,t,function(){e.ctrlBlock.level>e.maxLevel?setTimeout(function(){0!=c.length?e.oneBlcokChangeCtrlBlock(c[0],function(){c[0].destroy(),c.splice(0,1),e.moveAllOverCallFun(t,c)}):e.moveAllOverCallFun(t,c)},100):e.moveAllOverCallFun(t,c)})}else e.moveAllOverCallFun(t,c)})):l?(c[0].destroy(),c.splice(0,1),void this.ctrlBlockLevelUp("left",function(){if(c.length>0){var r;r=e.ctrlBlock.arc>c[0].arc?e.ctrlBlock.arc-c[0].arc-c[0].selfArcHarf-e.ctrlBlock.selfArcHarf:e.ctrlBlock.arc+(2*e.pi-c[0].arc)-c[0].selfArcHarf-e.ctrlBlock.selfArcHarf,e.moveAllBlcokToLeftOrRight("left",r,c,function(){e.ctrlBlock.level>e.maxLevel?setTimeout(function(){0!=t.length?e.oneBlcokChangeCtrlBlock(t[0],function(){t[0].destroy(),t.splice(0,1),e.moveAllOverCallFun(t,c)}):e.moveAllOverCallFun(t,c)},100):e.moveAllOverCallFun(t,c)})}else e.moveAllOverCallFun(t,c)})):void 0;setTimeout(function(){e.changeCtrlBlock()},this.speedMillisecond)},isBlockLfetOrRight:function(t,c){if(void 0===c||void 0===t)return"";var e=c.arc,r=e>this.pi?e-this.pi:e+this.pi;return e<=this.pi?t.arc>e&&t.arc<r?"left":"right":t.arc<e&&t.arc>r?"right":"left"},moveToNearestBlock:function(){var t=this.blockArr,c=[],e=this.ctrlBlock.arc;if(1!=t.length)if(e<t[0].arc)(c=this.reSort(0))[0].arc-e<e+(2*this.pi-c[c.length-1].arc)?this.moveToBlockByCircle(c,"right",0):this.moveToBlockByCircle(c,"left",c.length-1);else if(e>t[t.length-1].arc)(c=this.reSort(0))[0].arc+(2*this.pi-e)<e-c[c.length-1].arc?this.moveToBlockByCircle(c,"right",0):this.moveToBlockByCircle(c,"left",c.length-1);else for(var r=0;r<t.length;r++)e>t[r].arc&&e<t[r+1].arc&&((c=this.reSort(r+1))[0].arc-e<e-c[c.length-1].arc?this.moveToBlockByCircle(c,"right",0):this.moveToBlockByCircle(c,"left",c.length-1));else"left"==this.isBlockLfetOrRight(this.ctrlBlock,t[0])?this.moveToBlockByCircle(t,"left",0):this.moveToBlockByCircle(t,"right",0)},moveToBlockByCircle:function(t,c,e){var r=this,l=2*this.pi,i=t[e],o=this.ctrlBlock.selfArcHarf+i.selfArcHarf;o="right"==c?i.arc-o:i.arc+o,o=this.changeArc(o);var n=this.ctrlBlock.arc;this.ctrlBlock.arc=o;var s=Math.abs(o-n);"right"==c?n>this.pi&&o<this.pi&&(s=Math.abs(l-n+o)):o>this.pi&&n<this.pi&&(s=Math.abs(l-o+n)),this.playEffect();var a=cc.sequence(this.actionBy,cc.callFunc(function(){r.romoveMotion();var l=[],i=cc.callFunc(function(){r.moveToBlockByCircleCallFun(t,e)});if(s>.01)for(var a=parseInt(s/.01),h=0;h<a+1;h++)if(h==a){var f=r.getPosition(o,r.circleRadius),u=cc.moveTo(.003,cc.v2(f.x,f.y));l.push(u),l.push(i)}else{var v="right"==c?n+.01*(h+1):n-.01*(h+1),k=r.getPosition(v,r.circleRadius),B=cc.moveTo(.003,cc.v2(k.x,k.y));l.push(B)}else{var g=r.getPosition(o,r.circleRadius),d=cc.moveTo(r.speedMove,cc.v2(g.x,g.y));l.push(d),l.push(i)}var m=cc.sequence(l);setTimeout(function(){r.ctrlBlock.runAction(m)},10)}));this.ctrlBlock.runAction(a)},moveToBlockByCircleCallFun:function(t,c){var e=this,r=t[c];if(this.checkLevel(r))return 0==c&&1==t.length?(t[0].destroy(),void this.ctrlBlockLevelUp("mid",function(){e.changeCtrlBlock()})):0==c?(t[c].destroy(),t.splice(c,1),void this.ctrlBlockLevelUp("right",function(){var c;t.length>0?(c=t[0].arc-e.ctrlBlock.arc-t[0].selfArcHarf-e.ctrlBlock.selfArcHarf,e.moveAllBlcokToLeftOrRight("right",c,t,function(){e.moveToBlockByCircleCallFun(t,0)})):e.changeCtrlBlock()})):(t[c].destroy(),t.splice(c,1),void this.ctrlBlockLevelUp("left",function(){var r;t.length>0?(r=e.ctrlBlock.arc-t[c-1].arc-t[c-1].selfArcHarf-e.ctrlBlock.selfArcHarf,e.moveAllBlcokToLeftOrRight("left",r,t,function(){e.moveToBlockByCircleCallFun(t,c-1)})):e.changeCtrlBlock()}));this.changeCtrlBlock()},checkLevel:function(t){return t.level==this.ctrlBlock.level},ctrlBlockLevelUp:function(t,c){var e=this;this.playEffectBoomAudioClip(),this.ctrlBlock.getChildByName("boom").getComponent(cc.Animation).play(),this.scoreLabel.string=parseInt(this.scoreLabel.string)+parseInt(this.ctrlBlock.level),this.scoreImg(this.scoreLabel.string);var r=this.blockSize+this.ctrlBlock.level*this.blockSizeAdd,l=this.getBlcokArc(r/2)/2,i=this.ctrlBlock.arc;"right"==t?i=this.ctrlBlock.arc-this.ctrlBlock.selfArcHarf+l:"left"==t&&(i=this.ctrlBlock.arc+this.ctrlBlock.selfArcHarf-l);var o=this.getPosition(i,this.circleRadius);this.ctrlBlock.getChildByName("ctrlBlock").runAction(cc.scaleTo(.2,0,0)),setTimeout(function(){e.ctrlBlock.level=e.ctrlBlock.level+1,e.ctrlBlock.setPosition(cc.v2(o.x,o.y)),e.ctrlBlock.level<e.maxLevel+1?(e.ctrlBlock.setContentSize(cc.size(r,r)),e.ctrlBlock.getChildByName("ctrlBlock").setContentSize(cc.size(r,r)),e.ctrlBlock.getChildByName("ctrlBlock").getComponent(cc.Sprite).spriteFrame=e.blockAtlas.getSpriteFrame(e.ctrlBlock.level.toString()),e.ctrlBlock.getChildByName("ctrlBlock").runAction(cc.scaleTo(.2,1,1)),setTimeout(function(){e.ctrlBlock.getChildByName("boom").color=e.colorArr[e.ctrlBlock.level]},400),e.ctrlBlock.selfArcHarf=l,e.ctrlBlock.arc=i):(e.ctrlBlock.setContentSize(cc.size(0,0)),e.ctrlBlock.getChildByName("ctrlBlock").setContentSize(cc.size(0,0)),"right"==t?i-=l:"left"==t&&(i+=l),e.ctrlBlock.arc=i,e.ctrlBlock.selfArcHarf=0),c&&c()},200)},oneBlcokChangeCtrlBlock:function(t,c){var e=t.level,r=new cc.Node("Node"),l=new cc.Node("Sprite");l.parent=r,l.name="ctrlBlock";var i=l.addComponent(cc.Sprite);i.sizeMode="CUSTOM",i.spriteFrame=this.blockAtlas.getSpriteFrame(e.toString()),r.setPosition(cc.v2(t.x,t.y));var o=this.blockSize+(e-1)*this.blockSizeAdd;r.setContentSize(cc.size(o,o)),l.setContentSize(cc.size(o,o)),r.selfArcHarf=t.selfArcHarf,r.arc=t.arc,r.level=e,r.parent=this.ctrlBlockArea;var n=cc.instantiate(this.boomPrefal);n.parent=r,n.color=this.colorArr[e],this.ctrlBlock.destroy(),this.ctrlBlock=r,c&&c()},getDelta:function(t,c){var e=t.arc-c.arc;return Math.abs(e)>this.pi&&(e=c.arc>this.pi?2*this.pi-c.arc+t.arc:2*this.pi-t.arc+c.arc),Math.abs(e)},gameOverAction:function(t,c,e,r){var l=this,i=cc.repeat(cc.sequence(cc.scaleTo(.5,.7,.7),cc.scaleTo(.5,1,1)),3),o=cc.repeat(cc.sequence(cc.scaleTo(.5,.7,.7),cc.scaleTo(.5,1,1)),2);t.runAction(i),c.runAction(o),setTimeout(function(){if(e.length>0&&r.length>0){e=e.reverse(),r=r.reverse();for(var t=function(t){t==e.length?e.length>=r.length&&setTimeout(function(){l.playEffectBoomAudioClip(),l.ctrlBlock.getChildByName("boom").getComponent(cc.Animation).play(),l.ctrlBlock.destroy(),l.gameOverScene()},150*t):setTimeout(function(){l.boomArr(e[t])},150*t)},c=0;c<e.length+1;c++)t(c);for(var i=function(t){t==r.length?r.length>e.length&&setTimeout(function(){l.playEffectBoomAudioClip(),l.ctrlBlock.getChildByName("boom").getComponent(cc.Animation).play(),l.ctrlBlock.destroy(),l.gameOverScene()},150*t):setTimeout(function(){l.boomArr(r[t])},150*t)},o=0;o<r.length+1;o++)i(o)}0!=e.length&&0!=r.length||function(){var t=e.length>0?e:r;t=t.reverse();for(var c=function(c){c==t.length?setTimeout(function(){l.playEffectBoomAudioClip(),l.ctrlBlock.getChildByName("boom").getComponent(cc.Animation).play(),l.ctrlBlock.destroy(),l.gameOverScene()},150*c):setTimeout(function(){l.boomArr(t[c])},150*c)},i=0;i<t.length+1;i++)c(i)}()},2e3)},boomArr:function(t){var c=cc.instantiate(this.boomPrefal);c.color=this.colorArr[t.level],c.setPosition(cc.v2(t.x,t.y)),c.parent=this.blockBox,this.playEffectBoomAudioClip(),c.getComponent(cc.Animation).play(),t.destroy()},checkIsGameOver:function(t,c,e,r){if(t.length>0&&c.length>0){var l=t[t.length-1],i=c[c.length-1];return this.getDelta(l,i)-l.selfArcHarf-i.selfArcHarf<=2*this.ctrlBlock.selfArcHarf&&(this.gameOverAction(l,i,t,c),!0)}if(0==t.length){var o=c[c.length-1],n=this.ctrlBlock;return this.getDelta(o,n)-o.selfArcHarf-n.selfArcHarf<=r&&(this.gameOverAction(o,n,t,c),!0)}if(0==c.length){var s=t[t.length-1],a=this.ctrlBlock;return this.getDelta(s,a)-s.selfArcHarf-a.selfArcHarf<=e&&(this.gameOverAction(s,a,t,c),!0)}},gameOverScene:function(){this.gameOverScore.string=this.scoreLabel.string,this.gameOver.active=!0},clickStart:function(){var t=this;FBInstant.getInterstitialAdAsync("541606183515187_542798350062637").then(function(t){return t.loadAsync()}).then(function(){return t.init(),null.showAsync()}).catch(function(t){console.log(t)})},clickFuhuo:function(t,c){var e=this,r=null;FBInstant.getRewardedVideoAsync("541606183515187_542797943396011").then(function(t){return void 0!==t?(void 0===t.getPlacementID()&&console.log("can not get placement ID"),r=t,t.loadAsync()):Promise.reject(new Error("rewardedVideo is undefined"))}).then(function(){return r.showAsync()}).then(function(){if("fuhuo"==c)e.init("fuhuo");else{var t=this.randomNum(4),r=this.ctrlBlock.level;this.waitBlcok&&this.waitBlcok.destroy(),this.ctrlBlock&&this.ctrlBlock.destroy(),t==r&&(t=this.createBlockCheckIsSame(t)),this.createBlock(!0,t)}}).catch(function(t){console.log(t)})},shareGame:function(){FBInstant.context.chooseAsync().then(function(){FBInstant.updateAsync({action:"CUSTOM",template:"top_score",cta:"Race "+FBInstant.player.getName(),image:"BASE64",text:{default:"I Challenge You To A Race!"},data:{myReplayData:"..."},strategy:"LAST",notification:"NO_PUSH"}).then(function(){})})},playEffect:function(){cc.audioEngine.play(this.audioClip,!1,1)},playEffectBoomAudioClip:function(){cc.audioEngine.play(this.boomAudioClip,!1,1)},handPlay:function(){this.handNode.getComponent(cc.Animation).play()},handStop:function(){this.handNode.getComponent(cc.Animation).stop()},scoreImg:function(){},onLoad:function(){this.init()},start:function(){},update:function(){}}),cc._RF.pop()},{}]},{},["game"]);