(function(){define("pages/borrow/zion_index",["jquery","handlebars"],function(a,b,c){var d,e,f,g,h,i,j,k,l;return d=a("jquery"),g=a("handlebars"),k=window.userFeeRate||"HR",h=window.allFeeRate||{},e={},f={0:3e3,126:1e4,444:1e5,622:2e5,728:5e5},i={def:{offset:55,minoffset:0,maxoffset:728,min:3e3,max:5e5,step:1e3,delay:200,text:"#J_text_borrow-amount",holder:"#J_borrow-amount-slider",line:"#J_borrow-slider-line",trigger:"#J_borrow-slider-trigger",up:"#J_borrow-slider-right",down:"#J_borrow-slider-left"},increaseVal:function(){var a,b,c;return a=this,b=a.option,c=b.text.val()-0,c=a.sanitizeVal(c+b.step),a.setVal(c),a.money2silder()},decreaseVal:function(){var a,b,c;return a=this,b=a.option,c=b.text.val()-0,c=a.sanitizeVal(c-b.step),a.setVal(c),a.money2silder()},sanitizeVal:function(a){var b,c,d,e,f,g;return c=this,e=c.option,f=a,d=e.min,b=e.max,a=parseInt("0"+a,10),d>a&&(a=d),a>b&&(a=b),1e4>=a&&(e.step=1e3),a>1e4&&(e.step=5e3),a>1e5&&(e.step=1e4),a>2e5&&(e.step=5e4),g=e.step,a%g!==0&&(a=a-a%g+g),a},setVal:function(a){var b;return b=this,b.option.text.val(a)},setOffset:function(a){var b,c,d,e,f,g,h;return c=this,g=c.option,e=g.offset,f=36,b=g.maxoffset,d=g.minoffset,h=parseInt("0"+a,10),h-=e,h>b&&(h=b),d>h&&(h=d),g.line.css({width:h}),g.trigger.css({left:h+f})},silder2money:function(a){var b,c,d,e,g,h,i,j,k,l,m,n;g=this,k=g.option,j=k.offset,e=k.maxoffset,h=k.minoffset,a-=j,a>e&&(a=e),h>a&&(a=h),d=k.min,i=k.max,b=f,a===h&&g.setVal(g.sanitizeVal(k.min)),a===e&&g.setVal(g.sanitizeVal(k.max));for(c in b)if(m=b[c],a>=c&&(d=c),c>=a){i=c;break}return i===d?(g.setVal(g.sanitizeVal(b[i])),g.renderTable(),g):(l=(b[i]-b[d])/(i-d),n=(a-d)*l+b[d],g.setVal(g.sanitizeVal(n)),g.renderTable(),g)},money2silder:function(a){var b,c,d,e,g,h,i,j,k,l,m;e=this,i=e.option,h=i.offset,g=i.minoffset,d=i.maxoffset,b=f,l=parseInt("0"+i.text.val(),10),a&&(l%100!==0&&(l=100*Math.ceil(l/100)),l<i.min&&(l=3e3),l>i.max&&(l=5e5),e.setVal(l)),l=e.sanitizeVal(i.text.val());for(c in b)if(k=b[c],l>k&&(g=c),k>=l){d=c;break}return j=(b[d]-b[g])/(d-g),m=g,m=m-0+(l-b[g])/j,m+=h,e.setOffset(m),e.renderTable()},renderTable:function(){var a,b,c,f,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;j="J_borrow-table-tr",l=this,n=l.option,f=n.table,c=h,r=d(".icon-cash",f.parent("table")),q=d(".ui-poptip-content","#J_borrow-month-fee-rate"),o=parseInt("0"+d("#J_text_borrow-amount").val(),10),p={},a=function(a,b){var c;return c=100*o,c=parseInt(Math.round(c/a+o*b),10)/100,c.toFixed(2)},b=function(b,c){var d;return d=a(b,c),d=100*d*b/100,d.toFixed(2)},s=e[j]?e[j]:e[j]=g.compile(d("#"+j).html()),m=d(":radio:checked",f).val();for(i in c)u=c[i],-1!==i.indexOf(k+"_")&&(p[u.month]=u);for(f.html(""),w=!1,v=0,z=[3,6,12,24],x=0,y=z.length;y>x;x++)i=z[x],u=p[i],u&&(u.hasDiscount=w=u.discountRadio<100?!0:!1,u.monthFeeRate=u.finalMonthlyComprehensiveFeeRate,u.payment=o,u.monthPay=a(u.month,u.monthFeeRate),u.totalPay=b(u.month,u.monthFeeRate),u.monthFeeRate=u.monthFeeRate.toFixed(2),t=s(u),v=u.monthlyComprehensiveFeeRate,f.append(t));return w?(q.html(["借款费率大优惠。原始月综合费率为",v,"%。"].join("")),r.removeClass("fn-hide")):r.addClass("fn-hide")},_bindClickAndHold:function(a,b,c){var d,e;return e=null,d=function(){return e=setTimeout(function(){return b(),d()},c)},a.on("mousedown",function(){return d(),!1}).on("mouseup mouseout",function(){return clearTimeout(e),!1}).on("click dbclick",function(){return b(),!1})},_bindWheelEvent:function(){var a,b,c;return b=this,c=b.option,a=0},_bindTableEvent:function(){var a,b,c;return a=this,b=a.option,c=b.table=d("#J_borrow-table"),c.on("click","tr",function(){return d(":radio",this).get(0).checked=!0,d(this).addClass("active").siblings().removeClass("active")}).on("mouseenter","tr",function(){return d(this).addClass("active")}).on("mouseleave","tr",function(){return d(":radio",this).get(0).checked?void 0:d(this).removeClass("active")})},_bindDragEvent:function(){var a,b,c,e,f,g,h;return e=this,g=e.option,a=g.holder,h=g.trigger,c=g.line,b=0,f=function(c){var d;if(b)return d=c.pageX-a.offset().left,e.setOffset(d),e.silder2money(d)},h.on("mousedown",function(){return b=1,!1}).on("mouseup mouseout",function(){return b=0,!1}),a.on("mousedown",function(a){var b;return b=a.offsetX,e.setOffset(b),e.silder2money(b)}),d(document).on("mousemove",f)},bindEvent:function(){var a,b;return a=this,b=a.option,a._bindClickAndHold(b.up,function(){return a.increaseVal()},b.delay),a._bindClickAndHold(b.down,function(){return a.decreaseVal()},b.delay),a._bindDragEvent(),a._bindWheelEvent(),a._bindTableEvent(),b.text.on("keyup",function(){return a.money2silder()}),b.text.on("blur",function(){return a.money2silder(!0)}),a},init:function(a){var b,c,e,f,g;for(c=this,c.option=d.extend({},c.def,a),g=["text","line","holder","trigger","up","down"],e=0,f=g.length;f>e;e++)b=g[e],c.option[b]=d(c.option[b]);return c.bindEvent(),c.money2silder(),c}},j={def:{idx:0,trigger:"#J_borrow-step-trigger",holder:"#J_borrow-step-holder"},next:function(){var a,b;return a=this,b=a.option,a.switchTo(++b.idx)},last:function(){var a,b;return a=this,b=a.option,a.switchTo(--b.idx)},switchTo:function(a){var b,c,e,f,g,h,i;return e=this,f=e.option,h=f.trigger,i=d("li",h),c=i.length,b=f.holder,g=d("div:lt("+c+")",f.holder),a>=c&&(a=c-1),0>=a&&(a=0),f.idx=a,i.removeClass("ui-step-active ui-step-pass").filter(":lt("+a+")").addClass("ui-step-pass").end().eq(a).addClass("ui-step-active"),g.addClass("hide").eq(a).removeClass("hide"),e},bindEvent:function(){var a,b,c,e;return b=this,c=b.option,e=c.trigger,a=c.holder,e.on("click","li",function(){return b.switchTo(d("li",e).index(this))}),a.on("click",".arrow-left",function(){return b.last()}).on("click",".arrow-right",function(){return b.next()})},init:function(a){var b,c,e,f,g;for(c=this,c.option=d.extend({},c.def,a),g=["trigger","holder"],e=0,f=g.length;f>e;e++)b=g[e],c.option[b]=d(c.option[b]);return c.bindEvent(),c}},l=function(){return i.init(),j.init()},c.exports={init:l}})}).call(this);